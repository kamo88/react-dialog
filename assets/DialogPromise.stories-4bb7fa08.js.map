{"version":3,"file":"DialogPromise.stories-4bb7fa08.js","sources":["../../src/components/Dialog/hooks/useDialogPromise.ts"],"sourcesContent":["import { useCallback, useEffect, useRef, useState } from 'react';\n\nexport const DialogResponse = {\n  main: 'main',\n  sub: 'sub',\n  abort: 'abort',\n} as const;\n\nexport type DialogResponseState =\n  (typeof DialogResponse)[keyof typeof DialogResponse];\n\nexport const useDialogPromise = () => {\n  const ref = useRef<HTMLDialogElement>(null);\n\n  const promiseState = useRef(\n    new Promise<DialogResponseState>((resolve) => {\n      resolve('abort');\n    }),\n  );\n\n  const resolveState = useRef<(value: DialogResponseState) => void>(\n    () => () => {\n      // noop\n    },\n  );\n\n  const [isOpen, setIsOpen] = useState(false);\n\n  const showDialog = useCallback(() => {\n    resolveState.current('abort');\n    setIsOpen(true);\n    ref.current?.showModal();\n    promiseState.current = new Promise<DialogResponseState>((resolve) => {\n      resolveState.current = resolve;\n    });\n    return promiseState.current;\n  }, []);\n\n  const closeDialogMain = useCallback(() => {\n    setIsOpen(false);\n    ref.current?.close();\n    resolveState.current('main');\n  }, []);\n\n  const closeDialogSub = useCallback(() => {\n    setIsOpen(false);\n    ref.current?.close();\n    resolveState.current('sub');\n  }, []);\n\n  const closeDialogAbort = useCallback(() => {\n    setIsOpen(false);\n    ref.current?.close();\n    resolveState.current('abort');\n  }, []);\n\n  useEffect(() => () => closeDialogAbort(), [closeDialogAbort]);\n\n  return {\n    ref,\n    isOpen,\n    showDialog,\n    closeDialogMain,\n    closeDialogSub,\n    closeDialogAbort,\n  };\n};\n"],"names":["DialogResponse","useDialogPromise","ref","useRef","promiseState","resolve","resolveState","isOpen","setIsOpen","useState","showDialog","useCallback","_a","closeDialogMain","closeDialogSub","closeDialogAbort","useEffect"],"mappings":"sKAEO,MAAMA,EAAiB,CAC5B,KAAM,OACN,IAAK,MACL,MAAO,OACT,EAKaC,EAAmB,IAAM,CAC9B,MAAAC,EAAMC,SAA0B,IAAI,EAEpCC,EAAeD,EAAA,OACnB,IAAI,QAA8BE,GAAY,CAC5CA,EAAQ,OAAO,CAAA,CAChB,CAAA,EAGGC,EAAeH,EAAA,OACnB,IAAM,IAAM,CAEZ,CAAA,EAGI,CAACI,EAAQC,CAAS,EAAIC,WAAS,EAAK,EAEpCC,EAAaC,EAAAA,YAAY,IAAM,OACnC,OAAAL,EAAa,QAAQ,OAAO,EAC5BE,EAAU,EAAI,GACdI,EAAAV,EAAI,UAAJ,MAAAU,EAAa,YACbR,EAAa,QAAU,IAAI,QAA8BC,GAAY,CACnEC,EAAa,QAAUD,CAAA,CACxB,EACMD,EAAa,OACtB,EAAG,CAAE,CAAA,EAECS,EAAkBF,EAAAA,YAAY,IAAM,OACxCH,EAAU,EAAK,GACfI,EAAAV,EAAI,UAAJ,MAAAU,EAAa,QACbN,EAAa,QAAQ,MAAM,CAC7B,EAAG,CAAE,CAAA,EAECQ,EAAiBH,EAAAA,YAAY,IAAM,OACvCH,EAAU,EAAK,GACfI,EAAAV,EAAI,UAAJ,MAAAU,EAAa,QACbN,EAAa,QAAQ,KAAK,CAC5B,EAAG,CAAE,CAAA,EAECS,EAAmBJ,EAAAA,YAAY,IAAM,OACzCH,EAAU,EAAK,GACfI,EAAAV,EAAI,UAAJ,MAAAU,EAAa,QACbN,EAAa,QAAQ,OAAO,CAC9B,EAAG,CAAE,CAAA,EAELU,OAAAA,EAAAA,UAAU,IAAM,IAAMD,EAAoB,EAAA,CAACA,CAAgB,CAAC,EAErD,CACL,IAAAb,EACA,OAAAK,EACA,WAAAG,EACA,gBAAAG,EACA,eAAAC,EACA,iBAAAC,CAAA,CAEJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}