{"version":3,"file":"UseDialogPromise.stories-893526f9.js","sources":["../../src/utils/noop.ts","../../src/components/Dialog/hooks/useDialogPromise.ts"],"sourcesContent":["export type Noop = () => void;\n\nexport const noop: Noop = () => {\n  // noop\n};\n","import { noop } from '@/utils/noop';\nimport { useCallback, useEffect, useRef, useState } from 'react';\n\nexport const DialogResponse = {\n  main: 'main',\n  sub: 'sub',\n  abort: 'abort',\n} as const;\n\nexport type DialogResponseState =\n  (typeof DialogResponse)[keyof typeof DialogResponse];\n\nexport const useDialogPromise = () => {\n  const ref = useRef<HTMLDialogElement>(null);\n\n  const promiseState = useRef(\n    new Promise<DialogResponseState>((resolve) => {\n      resolve('abort');\n    }),\n  );\n\n  const resolveState = useRef<((value: DialogResponseState) => void) | null>(\n    () => noop,\n  );\n\n  const [isOpen, setIsOpen] = useState(false);\n\n  const showDialog = useCallback(() => {\n    if (ref.current?.open) {\n      return promiseState.current;\n    }\n\n    setIsOpen(true);\n    ref.current?.showModal();\n    promiseState.current = new Promise<DialogResponseState>((resolve) => {\n      resolveState.current = resolve;\n    });\n    return promiseState.current;\n  }, []);\n\n  const closeDialogMain = useCallback(() => {\n    if (!ref.current?.open) return;\n    setIsOpen(false);\n    ref.current?.close();\n    resolveState.current?.('main');\n  }, []);\n\n  const closeDialogSub = useCallback(() => {\n    if (!ref.current?.open) return;\n    setIsOpen(false);\n    ref.current?.close();\n    resolveState.current?.('sub');\n  }, []);\n\n  const closeDialogAbort = useCallback(() => {\n    if (!ref.current?.open) return;\n    setIsOpen(false);\n    ref.current?.close();\n    resolveState.current?.('abort');\n  }, []);\n\n  useEffect(() => {\n    const dialogRef = ref.current;\n\n    return () => {\n      setIsOpen(false);\n      dialogRef?.close();\n      resolveState.current?.('abort');\n    };\n  }, []);\n\n  return {\n    ref,\n    isOpen,\n    showDialog,\n    closeDialogMain,\n    closeDialogSub,\n    closeDialogAbort,\n  };\n};\n"],"names":["noop","DialogResponse","useDialogPromise","ref","useRef","promiseState","resolve","resolveState","isOpen","setIsOpen","useState","showDialog","useCallback","_a","_b","closeDialogMain","_c","closeDialogSub","closeDialogAbort","useEffect","dialogRef"],"mappings":"yIAEO,MAAMA,EAAa,IAAM,CAEhC,ECDaC,EAAiB,CAC5B,KAAM,OACN,IAAK,MACL,MAAO,OACT,EAKaC,EAAmB,IAAM,CAC9B,MAAAC,EAAMC,SAA0B,IAAI,EAEpCC,EAAeD,EAAA,OACnB,IAAI,QAA8BE,GAAY,CAC5CA,EAAQ,OAAO,CAAA,CAChB,CAAA,EAGGC,EAAeH,EAAA,OACnB,IAAMJ,CAAA,EAGF,CAACQ,EAAQC,CAAS,EAAIC,WAAS,EAAK,EAEpCC,EAAaC,EAAAA,YAAY,IAAM,SAC/B,OAAAC,EAAAV,EAAI,UAAJ,MAAAU,EAAa,OAIjBJ,EAAU,EAAI,GACdK,EAAAX,EAAI,UAAJ,MAAAW,EAAa,YACbT,EAAa,QAAU,IAAI,QAA8BC,GAAY,CACnEC,EAAa,QAAUD,CAAA,CACxB,GACMD,EAAa,OACtB,EAAG,CAAE,CAAA,EAECU,EAAkBH,EAAAA,YAAY,IAAM,YACnCC,EAAAV,EAAI,UAAJ,MAAAU,EAAa,OAClBJ,EAAU,EAAK,GACfK,EAAAX,EAAI,UAAJ,MAAAW,EAAa,SACbE,EAAAT,EAAa,UAAb,MAAAS,EAAA,KAAAT,EAAuB,QACzB,EAAG,CAAE,CAAA,EAECU,EAAiBL,EAAAA,YAAY,IAAM,YAClCC,EAAAV,EAAI,UAAJ,MAAAU,EAAa,OAClBJ,EAAU,EAAK,GACfK,EAAAX,EAAI,UAAJ,MAAAW,EAAa,SACbE,EAAAT,EAAa,UAAb,MAAAS,EAAA,KAAAT,EAAuB,OACzB,EAAG,CAAE,CAAA,EAECW,EAAmBN,EAAAA,YAAY,IAAM,YACpCC,EAAAV,EAAI,UAAJ,MAAAU,EAAa,OAClBJ,EAAU,EAAK,GACfK,EAAAX,EAAI,UAAJ,MAAAW,EAAa,SACbE,EAAAT,EAAa,UAAb,MAAAS,EAAA,KAAAT,EAAuB,SACzB,EAAG,CAAE,CAAA,EAELY,OAAAA,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAYjB,EAAI,QAEtB,MAAO,IAAM,OACXM,EAAU,EAAK,EACfW,GAAA,MAAAA,EAAW,SACXP,EAAAN,EAAa,UAAb,MAAAM,EAAA,KAAAN,EAAuB,QAAO,CAElC,EAAG,CAAE,CAAA,EAEE,CACL,IAAAJ,EACA,OAAAK,EACA,WAAAG,EACA,gBAAAI,EACA,eAAAE,EACA,iBAAAC,CAAA,CAEJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}