{"version":3,"file":"UseDialogPromise.stories-1cbf132f.js","sources":["../../src/utils/noop.ts","../../src/components/Dialog/hooks/useDialogPromise.ts"],"sourcesContent":["export type Noop = () => void;\n\nexport const noop: Noop = () => {\n  // noop\n};\n","import { noop } from '@/utils/noop';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport {\n  enableBodyScroll,\n  disableBodyScroll,\n  clearAllBodyScrollLocks,\n} from 'body-scroll-lock';\n\nexport const DialogResponse = {\n  main: 'main',\n  sub: 'sub',\n  abort: 'abort',\n} as const;\n\nexport type DialogResponseState =\n  (typeof DialogResponse)[keyof typeof DialogResponse];\n\nexport const useDialogPromise = () => {\n  const ref = useRef<HTMLDialogElement>(null);\n\n  const promiseState = useRef(\n    new Promise<DialogResponseState>((resolve) => {\n      resolve('abort');\n    }),\n  );\n\n  const resolveState = useRef<((value: DialogResponseState) => void) | null>(\n    () => noop,\n  );\n\n  const [isOpen, setIsOpen] = useState(false);\n\n  const showDialog = useCallback(() => {\n    if (ref.current?.open) {\n      return promiseState.current;\n    }\n\n    setIsOpen(true);\n    ref.current?.showModal();\n    if (ref.current) {\n      /**\n       * The dialog should appear on the entire screen.\n       * The only touchable elements other than the dialog should be the dialog's child elements.\n       */\n      disableBodyScroll(ref.current, {\n        allowTouchMove: () => true,\n      });\n    }\n    promiseState.current = new Promise<DialogResponseState>((resolve) => {\n      resolveState.current = resolve;\n    });\n    return promiseState.current;\n  }, []);\n\n  const closeDialogMain = useCallback(() => {\n    if (!ref.current?.open) return;\n    setIsOpen(false);\n    ref.current?.close();\n    resolveState.current?.('main');\n    if (ref.current) {\n      enableBodyScroll(ref.current);\n    }\n  }, []);\n\n  const closeDialogSub = useCallback(() => {\n    if (!ref.current?.open) return;\n    setIsOpen(false);\n    ref.current?.close();\n    resolveState.current?.('sub');\n    if (ref.current) {\n      enableBodyScroll(ref.current);\n    }\n  }, []);\n\n  const closeDialogAbort = useCallback(() => {\n    if (!ref.current?.open) return;\n    setIsOpen(false);\n    ref.current?.close();\n    resolveState.current?.('abort');\n    if (ref.current) {\n      enableBodyScroll(ref.current);\n    }\n  }, []);\n\n  useEffect(() => {\n    const dialogRef = ref.current;\n\n    return () => {\n      setIsOpen(false);\n      dialogRef?.close();\n      resolveState.current?.('abort');\n      clearAllBodyScrollLocks();\n    };\n  }, []);\n\n  return {\n    ref,\n    isOpen,\n    showDialog,\n    closeDialogMain,\n    closeDialogSub,\n    closeDialogAbort,\n  };\n};\n"],"names":["noop","DialogResponse","useDialogPromise","ref","useRef","promiseState","resolve","resolveState","isOpen","setIsOpen","useState","showDialog","useCallback","_a","_b","disableBodyScroll","closeDialogMain","_c","enableBodyScroll","closeDialogSub","closeDialogAbort","useEffect","dialogRef","clearAllBodyScrollLocks"],"mappings":"kKAEO,MAAMA,EAAa,IAAM,CAEhC,ECIaC,EAAiB,CAC5B,KAAM,OACN,IAAK,MACL,MAAO,OACT,EAKaC,EAAmB,IAAM,CAC9B,MAAAC,EAAMC,SAA0B,IAAI,EAEpCC,EAAeD,EAAA,OACnB,IAAI,QAA8BE,GAAY,CAC5CA,EAAQ,OAAO,CAAA,CAChB,CAAA,EAGGC,EAAeH,EAAA,OACnB,IAAMJ,CAAA,EAGF,CAACQ,EAAQC,CAAS,EAAIC,WAAS,EAAK,EAEpCC,EAAaC,EAAAA,YAAY,IAAM,SAC/B,OAAAC,EAAAV,EAAI,UAAJ,MAAAU,EAAa,OAIjBJ,EAAU,EAAI,GACdK,EAAAX,EAAI,UAAJ,MAAAW,EAAa,YACTX,EAAI,SAKNY,EAAkBZ,EAAI,QAAS,CAC7B,eAAgB,IAAM,EAAA,CACvB,EAEHE,EAAa,QAAU,IAAI,QAA8BC,GAAY,CACnEC,EAAa,QAAUD,CAAA,CACxB,GACMD,EAAa,OACtB,EAAG,CAAE,CAAA,EAECW,EAAkBJ,EAAAA,YAAY,IAAM,YACnCC,EAAAV,EAAI,UAAJ,MAAAU,EAAa,OAClBJ,EAAU,EAAK,GACfK,EAAAX,EAAI,UAAJ,MAAAW,EAAa,SACbG,EAAAV,EAAa,UAAb,MAAAU,EAAA,KAAAV,EAAuB,QACnBJ,EAAI,SACNe,EAAiBf,EAAI,OAAO,EAEhC,EAAG,CAAE,CAAA,EAECgB,EAAiBP,EAAAA,YAAY,IAAM,YAClCC,EAAAV,EAAI,UAAJ,MAAAU,EAAa,OAClBJ,EAAU,EAAK,GACfK,EAAAX,EAAI,UAAJ,MAAAW,EAAa,SACbG,EAAAV,EAAa,UAAb,MAAAU,EAAA,KAAAV,EAAuB,OACnBJ,EAAI,SACNe,EAAiBf,EAAI,OAAO,EAEhC,EAAG,CAAE,CAAA,EAECiB,EAAmBR,EAAAA,YAAY,IAAM,YACpCC,EAAAV,EAAI,UAAJ,MAAAU,EAAa,OAClBJ,EAAU,EAAK,GACfK,EAAAX,EAAI,UAAJ,MAAAW,EAAa,SACbG,EAAAV,EAAa,UAAb,MAAAU,EAAA,KAAAV,EAAuB,SACnBJ,EAAI,SACNe,EAAiBf,EAAI,OAAO,EAEhC,EAAG,CAAE,CAAA,EAELkB,OAAAA,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAYnB,EAAI,QAEtB,MAAO,IAAM,OACXM,EAAU,EAAK,EACfa,GAAA,MAAAA,EAAW,SACXT,EAAAN,EAAa,UAAb,MAAAM,EAAA,KAAAN,EAAuB,SACCgB,GAAA,CAE5B,EAAG,CAAE,CAAA,EAEE,CACL,IAAApB,EACA,OAAAK,EACA,WAAAG,EACA,gBAAAK,EACA,eAAAG,EACA,iBAAAC,CAAA,CAEJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}